<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.dominator.mapper.ext.TPublicExt">
    <resultMap id="BaseResultMap" type="Dto">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Tue May 08 11:43:08 CST 2018.
        -->
        <id column="id" jdbcType="VARCHAR" property="id" />
        <result column="garden_id" jdbcType="VARCHAR" property="gardenId" />
        <result column="property_id" jdbcType="VARCHAR" property="propertyId" />
        <result column="building" jdbcType="VARCHAR" property="building" />
        <result column="floors" jdbcType="VARCHAR" property="floors" />
        <result column="room_number" jdbcType="VARCHAR" property="roomNumber" />
        <result column="people_number" jdbcType="VARCHAR" property="peopleNumber" />
        <result column="open_mode" jdbcType="VARCHAR" property="openMode" />
        <result column="price" jdbcType="DECIMAL" property="price" />
        <result column="unit_time" jdbcType="VARCHAR" property="unitTime" />
        <result column="description" jdbcType="VARCHAR" property="description" />
        <result column="free_equipment" jdbcType="VARCHAR" property="freeEquipment" />
        <result column="type" jdbcType="VARCHAR" property="type" />
        <result column="pic_url" jdbcType="VARCHAR" property="picUrl" />
        <result column="remarks" jdbcType="VARCHAR" property="remarks" />
        <result column="modify_time" jdbcType="TIMESTAMP" property="modifyTime" />
        <result column="create_time" jdbcType="TIMESTAMP" property="createTime" />
        <result column="modify_id" jdbcType="VARCHAR" property="modifyId" />
        <result column="is_valid" jdbcType="VARCHAR" property="isValid" />

        <result column="user_id" jdbcType="VARCHAR" property="userId" />
        <result column="public_id" jdbcType="VARCHAR" property="publicId" />
        <result column="start_time" jdbcType="TIMESTAMP" property="startTime" />
        <result column="end_time" jdbcType="TIMESTAMP" property="endTime" />
        <result column="order_amount" jdbcType="DECIMAL" property="orderAmount" />
        <result column="status" jdbcType="VARCHAR" property="status" />
    </resultMap>

    <select id="getOrderList" parameterType="Dto" resultType="Dto" resultMap="BaseResultMap">
        SELECT apr.*, ap.title, ap.type, ap.price, ap.pic_url
        FROM t_appoint_public ap, t_appoint_public_record apr
        WHERE ap.is_valid = '1'
        AND apr.is_valid = '1'
        AND ap.id = apr.public_id
        <if test="userId!=null and !&quot;&quot;.equals(userId)">
            AND apr.user_id = #{userId}
        </if>
        <if test="type!=null and !&quot;&quot;.equals(type)">
            AND ap.type = #{type}
        </if>
        <if test="status!=null and !&quot;&quot;.equals(status)">
            AND apr.status = #{status}
        </if>
        <if test="orderId!=null and !&quot;&quot;.equals(orderId)">
            AND apr.id = #{orderId}
        </if>
        ORDER BY apr.start_time
    </select>
</mapper>